<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Julia Set</title>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.min.js"></script>
    <script>
        // Variables
        // Setup
        // Draw
        // Functions


        // 1. Variables

        // 2. Setup
        function setup() {
            createCanvas(500,500);
            background(10, 10, 100);
            noLoop();
            // colorMode(HSB);
        }

        // 3. Draw
        function draw() {
            for (let i = 0; i < width; i++) {
                for (let j = 0; j < height; j++) {
                    
                    // if (isInJuliaSet(i, j)) {
                    //     stroke(255);
                    //     // point(i,j);
                    // } else {
                    //     stroke(0);
                    //     // point(i, j);
                    // }


                    stroke(getJuliaColor(i, j)%255, 0, 0);
                    // stroke(map(getJuliaColor(i, j),0,500, 80, 255), 5, 10);  // RGB
                    // stroke(map(getJuliaColor(i, j),0,500, 0, 360), 100, 100); //HSB
                    
                    // let iter = getJuliaColor(i,j);
                    // stroke(map(sin(iter),-1, 1, 0, 255),  0, map(cos(iter), -1, 1, 0, 255));
                    
                    // let iter = getMandelbrotColor(i,j);
                    // stroke(map(sin(iter),-1, 1, 0, 255),  0, map(cos(iter), -1, 1, 0, 255));
                    
                    point(i,j);
                }
            }
        }

        // 4. Functions

        // function isInJuliaSet(x, y) {
        //     const maxTimes = 100;
        //     let sx = map(x, 0, width, -2, +2);
        //     let sy = map(y, 0, height, -2, +2);
        //     let i = 0;
        //     while(i < maxTimes) {
        //         let real = sx * sx - sy * sy;
        //         let imag = 2 * sx * sy;
        //         sx = real + 0.285;
        //         sy = imag + 0.01;
        //         if (sx * sx + sy * sy > 4) {
        //             return false;
        //         }
        //         i++;
        //     }
        //     return true;
        // }

        function getJuliaColor(x, y) {
            const maxTimes = 500;
            const zoomFactor = 0.5;
            const offsetX = -0.5;
            const offsetY = -0.5;
            let sx = map(x, 0, width, -2, +2) * zoomFactor + offsetX;
            let sy = map(y, 0, height, -2, +2) * zoomFactor + offsetY;
            let i = 0;
            while(i < maxTimes) {
                let real = sx * sx - sy * sy;
                let imag = 2 * sx * sy;
                sx = real + 0.285;
                sy = imag + 0.01;
                if (sx * sx + sy * sy > 4) {
                    return i;
                }
                i++;
            }
            return i;
        }
        // function getMandelbrotColor(x, y) {
        //     const maxTimes = 500;
        //     let cx = map(x, 0, width, -2, +2);
        //     let cy = map(y, 0, height, -2, +2);
        //     let i = 0;
        //     let zx=0;
        //     let zy=0;
        //     while(i < maxTimes) {
        //         let real = zx * zx - zy * zy;
        //         let imag = 2 * zx * zy;
        //         zx = real + cx;
        //         zy = imag + cy;
        //         if (zx * zx + zy * zy > 4) {
        //             return i;
        //         }
        //         i++;
        //     }
        //     return 0;
        // }

    </script>
</body>
</html>
